<%- include('partials/header') %>

<!-- About Page Content -->
<div class="bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
    <h2 class="text-2xl font-bold text-red-500 border-b-2 border-red-500 pb-2 mb-6">
        <i class="fas fa-info-circle mr-2"></i> Hakkımızda
    </h2>

    <div class="mb-8">
        <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fas fa-gamepad text-green-500 mr-3"></i> Sunucumuz Hakkında
        </h3>

        <div class="bg-gray-700 p-5 rounded-lg">
            <p class="mb-4">VESSELAM PRO PUBLIC, Türkiye'nin en aktif ve en kaliteli Counter-Strike 1.6 sunucularından biridir. Sunucumuz 7/24 aktif olup, her zaman en iyi oyun deneyimini sunmak için çalışmaktayız.</p>
            
            <p class="mb-4">Amacımız CS 1.6 severlere temiz, hile olmayan ve eğlenceli bir ortam sağlamaktır. Sunucumuzda özel modlar ve eklentiler bulunmakta, aynı zamanda düzenli olarak turnuvalar ve etkinlikler düzenlenmektedir.</p>
            
            <div class="bg-gray-600 p-4 rounded-lg mb-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="font-bold text-green-400 mb-2">Sunucu Özellikleri:</h4>
                        <ul class="list-disc list-inside space-y-1 text-gray-300">
                            <li>7/24 aktif ve stabil yapı</li>
                            <li>128 tick rate - Yüksek performans</li>
                            <li>Anti-cheat koruması</li>
                            <li>Özel modlar ve eklentiler</li>
                            <li>Düzenli harita değişimleri</li>
                            <li>Aktif admin desteği</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-bold text-red-400 mb-2">Teknik Bilgiler:</h4>
                        <ul class="space-y-1 text-gray-300">
                            <li><span class="text-gray-400">Lokasyon:</span> İstanbul, Türkiye</li>
                            <li><span class="text-gray-400">Sunucu Tipi:</span> Dedicated Server</li>
                            <li><span class="text-gray-400">İşletim Sistemi:</span> Linux</li>
                            <li><span class="text-gray-400">CPU:</span> Intel Xeon E5-2680v4</li>
                            <li><span class="text-gray-400">RAM:</span> 32 GB DDR4</li>
                            <li><span class="text-gray-400">Internet:</span> 1 Gbps bağlantı</li>
                        </ul>
                    </div>
                </div>
            </div>

            <p>Oyuncularımızın geri bildirimleri bizim için çok önemlidir. Sunucumuzu geliştirmek için her zaman yeni fikirler ve öneriler kabul ediyoruz. İletişim bölümünden bize ulaşabilirsiniz.</p>
        </div>
    </div>

    <div class="mb-8">
        <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fas fa-gavel text-yellow-500 mr-3"></i> Sunucu Kuralları
        </h3>

        <div class="bg-gray-700 p-5 rounded-lg">
            <p class="mb-4">Sunucumuzda herkese eşit ve adil bir oyun deneyimi sağlamak için belirli kurallarımız bulunmaktadır. Bu kurallara uyulmaması durumunda sunucudan uzaklaştırma cezası uygulanabilir.</p>
            
            <div class="space-y-4">
                <div class="p-3 bg-red-900/30 rounded-lg">
                    <h4 class="font-bold text-red-400">Kesinlikle Yasak Olanlar:</h4>
                    <ul class="list-disc list-inside space-y-1 text-gray-300">
                        <li>Her türlü hile, hack veya oyun avantajı sağlayan üçüncü parti yazılımlar</li>
                        <li>Diğer oyunculara küfür etmek, hakaret etmek veya taciz etmek</li>
                        <li>Irkçı, cinsiyetçi veya ayrımcı ifadeler kullanmak</li>
                        <li>Spam yapmak veya mikrofonu kötüye kullanmak</li>
                        <li>Takım arkadaşlarına zarar vermek (TK) veya kasıtlı olarak takıma zarar vermek</li>
                    </ul>
                </div>
                
                <div class="p-3 bg-yellow-900/30 rounded-lg">
                    <h4 class="font-bold text-yellow-400">Genel Kurallar:</h4>
                    <ul class="list-disc list-inside space-y-1 text-gray-300">
                        <li>Taktiksel oyun oynamaya çalışın ve takım arkadaşlarınızla işbirliği yapın</li>
                        <li>Oyunun akışını kasıtlı olarak bozmayın</li>
                        <li>Takım arkadaşlarınıza saygılı olun ve yardımcı olmaya çalışın</li>
                        <li>Yeni başlayan oyunculara karşı anlayışlı olun</li>
                        <li>Admin kararlarına saygı gösterin</li>
                    </ul>
                </div>
                
                <div class="p-3 bg-green-900/30 rounded-lg">
                    <h4 class="font-bold text-green-400">Önerilen Davranışlar:</h4>
                    <ul class="list-disc list-inside space-y-1 text-gray-300">
                        <li>Oyunda güzel atışlar yapan veya iyi taktik gösteren oyunculara tebriklerinizi iletin</li>
                        <li>Sunucu ve oyun hakkında yapıcı geri bildirimler paylaşın</li>
                        <li>Arkadaşlarınızı sunucumuza davet edin</li>
                        <li>Yeni oyuncuların sorularını yanıtlamaya çalışın</li>
                        <li>Discord sunucumuza katılın ve topluluğumuzun bir parçası olun</li>
                    </ul>
                </div>
            </div>
            
            <p class="mt-4 text-gray-400">Not: Adminler, kurallara göre hareket etme ve gerektiğinde ceza verme hakkına sahiptir. Kurallar güncellenebilir, lütfen düzenli olarak kontrol edin.</p>
        </div>
    </div>

    <!-- Yorumlar Bölümü -->
    <div class="mb-8">
        <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fas fa-comments text-blue-500 mr-3"></i> Yorumlar
        </h3>

        <div class="bg-gray-700 p-5 rounded-lg">
            <!-- Yorum Formu -->
            <% if (locals.isAuthenticated) { %>
                <form action="/about/comment" method="POST" class="mb-6" id="commentForm">
                    <div class="mb-3">
                        <textarea name="content" id="content" rows="3" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-white" placeholder="Bir yorum yazın..."></textarea>
                    </div>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
                        <i class="fas fa-paper-plane mr-2"></i> Yorum Gönder
                    </button>
                </form>
            <% } else { %>
                <div class="bg-blue-900/30 p-4 rounded-lg mb-6 border border-blue-800">
                    <p class="text-center text-gray-300">Yorum yapmak için <a href="/login" class="text-blue-400 hover:underline font-medium">giriş yapın</a> veya <a href="/register" class="text-green-400 hover:underline font-medium">kayıt olun</a>.</p>
                </div>
            <% } %>
            
            <!-- Yorumlar Listesi -->
            <div id="commentsContainer" class="space-y-4">
                <% if (locals.aboutComments && locals.aboutComments.length > 0) { %>
                    <% locals.aboutComments.forEach(function(comment) { %>
                        <div class="bg-gray-800 rounded-lg p-4 comment-item" data-id="<%= comment._id %>">
                            <div class="flex items-start">
                                <img src="<%= comment.author.profileImage %>" alt="<%= comment.author.username %>" class="w-10 h-10 rounded-full mr-3">
                                <div class="flex-1">
                                    <div class="flex justify-between mb-1">
                                        <a href="/user/<%= comment.author.username %>" class="text-blue-400 font-medium hover:underline">
                                            <%= comment.author.username %>
                                            <% if ((comment.author.role === 'site_admini' || comment.author.role === 'sunucu_sahibi' || comment.author.role === 'site_kurucusu') && !comment.author.hideRole) { %>
                                                <span class="ml-1 px-2 py-0.5 bg-red-900 text-red-200 text-xs rounded-full">
                                                    <%= comment.author.role === 'site_admini' ? 'Admin' : (comment.author.role === 'sunucu_sahibi' ? 'Sunucu Sahibi' : 'Site Kurucusu') %>
                                                </span>
                                            <% } %>
                                        </a>
                                        <span class="text-gray-500 text-sm">
                                            <%= new Date(comment.createdAt).toLocaleString('tr-TR', {dateStyle: 'short', timeStyle: 'short'}) %>
                                        </span>
                                    </div>
                                    <p class="text-gray-200"><%= comment.content %></p>
                                    <div class="mt-2 flex justify-between items-center">
                                        <div class="text-gray-500 text-sm">
                                            <!-- <span class="hover:text-blue-400 cursor-pointer"><i class="far fa-thumbs-up mr-1"></i> Beğen (0)</span> -->
                                        </div>
                                        <% if (locals.user && (comment.author._id.toString() === locals.user._id.toString() || ['site_admini', 'sunucu_sahibi', 'site_kurucusu'].includes(locals.user.role))) { %>
                                            <button class="text-gray-400 hover:text-red-400 delete-comment" data-id="<%= comment._id %>">
                                                <i class="fas fa-trash-alt mr-1"></i> Sil
                                            </button>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <div class="text-center py-6" id="no-comments-message">
                        <p class="text-gray-400 mb-2">Henüz yorum yapılmamış</p>
                        <p class="text-gray-500 text-sm">İlk yorumu yapan siz olun!</p>
                    </div>
                <% } %>
            </div>
        </div>
    </div>

    <div>
        <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fas fa-headset text-blue-500 mr-3"></i> İletişim
        </h3>

        <div class="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 p-5 rounded-lg shadow-lg border border-gray-600">
            <div class="text-center mb-6">
                <h4 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-red-400 to-blue-400 pb-1 inline-block">
                    Bize Ulaşın
                </h4>
                <div class="h-1 w-40 bg-gradient-to-r from-blue-500 via-red-500 to-blue-500 rounded mx-auto"></div>
                <p class="text-gray-400 mt-3">Sunucumuz hakkında soru, öneri ve görüşleriniz için bizimle iletişime geçebilirsiniz</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-3xl mx-auto">
                <!-- TeamSpeak Contact -->
                <div class="bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-lg shadow-xl border border-gray-700 hover:border-blue-500/50 transform transition-all duration-300 hover:shadow-blue-500/20 hover:shadow-xl hover:-translate-y-1 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-blue-900 to-indigo-900 flex items-center justify-center mb-5 shadow-lg group-hover:shadow-blue-500/20 transition-all duration-300">
                            <i class="fab fa-teamspeak text-blue-400 text-4xl group-hover:text-blue-300"></i>
                        </div>
                        <h5 class="font-bold text-xl text-white mb-3">TeamSpeak</h5>
                        <div class="bg-gray-900/80 py-2 px-4 rounded-lg mb-3 w-full">
                            <p class="text-blue-400 font-mono flex items-center justify-center">
                                <span class="mr-2">Vesselampro</span>
                                <button class="bg-blue-600 hover:bg-blue-700 p-1 rounded text-white" title="Kopyala">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </p>
                        </div>
                        <p class="text-gray-400">7/24 aktif sesli iletişim kanalımız</p>
                        <div class="mt-4 inline-block">
                            <a href="ts3server://Vesselampro" class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white py-2 px-4 rounded-lg transition-all duration-300 inline-flex items-center">
                                <i class="fas fa-headset mr-2"></i> Şimdi Bağlan
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Instagram Contact -->
                <div class="bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-lg shadow-xl border border-gray-700 hover:border-pink-500/50 transform transition-all duration-300 hover:shadow-pink-500/20 hover:shadow-xl hover:-translate-y-1 group">
                    <div class="flex flex-col items-center text-center">
                        <div class="w-20 h-20 rounded-xl bg-gradient-to-br from-pink-900 to-purple-900 flex items-center justify-center mb-5 shadow-lg group-hover:shadow-pink-500/20 transition-all duration-300">
                            <i class="fab fa-instagram text-pink-400 text-4xl group-hover:text-pink-300"></i>
                        </div>
                        <h5 class="font-bold text-xl text-white mb-3">Instagram</h5>
                        <div class="bg-gray-900/80 py-2 px-4 rounded-lg mb-3 w-full">
                            <p class="text-pink-400 font-mono">@vesselampropublic</p>
                        </div>
                        <p class="text-gray-400">Duyurular ve etkinlikler için takip edin</p>
                        <div class="mt-4 inline-block">
                            <a href="https://instagram.com/vesselampropublic" target="_blank" class="bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 text-white py-2 px-4 rounded-lg transition-all duration-300 inline-flex items-center">
                                <i class="fas fa-external-link-alt mr-2"></i> Profili Görüntüle
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Yorum işlemleri için JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Yorum Formu Gönderimi
    const commentForm = document.getElementById('commentForm');
    if (commentForm) {
      commentForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const content = document.getElementById('content').value;
        if (!content.trim()) return;
        
        fetch(commentForm.action, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          },
          body: JSON.stringify({ content })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            // Formu temizle
            document.getElementById('content').value = '';
            
            // Yorum listesine yeni yorumu ekle
            const commentsContainer = document.getElementById('commentsContainer');
            const noCommentsMessage = document.getElementById('no-comments-message');
            if (noCommentsMessage) {
              noCommentsMessage.remove();
            }
            
            // Yeni yorum elementi oluştur
            const comment = data.comment;
            const commentDate = new Date(comment.createdAt).toLocaleString('tr-TR', {dateStyle: 'short', timeStyle: 'short'});
            
            const newComment = document.createElement('div');
            newComment.className = 'bg-gray-800 rounded-lg p-4 comment-item';
            newComment.dataset.id = comment._id;
            
            // Rol bilgisi
            let roleSpan = '';
            if ((comment.author.role === 'site_admini' || comment.author.role === 'sunucu_sahibi' || comment.author.role === 'site_kurucusu') && !comment.author.hideRole) {
              const roleName = comment.author.role === 'site_admini' ? 'Admin' : (comment.author.role === 'sunucu_sahibi' ? 'Sunucu Sahibi' : 'Site Kurucusu');
              roleSpan = `<span class="ml-1 px-2 py-0.5 bg-red-900 text-red-200 text-xs rounded-full">${roleName}</span>`;
            }
            
            newComment.innerHTML = `
              <div class="flex items-start">
                <img src="${comment.author.profileImage}" alt="${comment.author.username}" class="w-10 h-10 rounded-full mr-3">
                <div class="flex-1">
                  <div class="flex justify-between mb-1">
                    <a href="/user/${comment.author.username}" class="text-blue-400 font-medium hover:underline">
                      ${comment.author.username}
                      ${roleSpan}
                    </a>
                    <span class="text-gray-500 text-sm">
                      ${commentDate}
                    </span>
                  </div>
                  <p class="text-gray-200">${comment.content}</p>
                  <div class="mt-2 flex justify-between items-center">
                    <div class="text-gray-500 text-sm">
                      <!-- <span class="hover:text-blue-400 cursor-pointer"><i class="far fa-thumbs-up mr-1"></i> Beğen (0)</span> -->
                    </div>
                    <button class="text-gray-400 hover:text-red-400 delete-comment" data-id="${comment._id}">
                      <i class="fas fa-trash-alt mr-1"></i> Sil
                    </button>
                  </div>
                </div>
              </div>
            `;
            
            // Yorumu listenin en üstüne ekle
            commentsContainer.insertBefore(newComment, commentsContainer.firstChild);
            
            // Silme butonlarına event listener ekle
            initDeleteButtons();
          }
        })
        .catch(error => console.error('Yorum ekleme hatası:', error));
      });
    }
    
    // Yorum Silme Butonları
    function initDeleteButtons() {
      const deleteButtons = document.querySelectorAll('.delete-comment');
      deleteButtons.forEach(button => {
        button.addEventListener('click', function() {
          const commentId = this.dataset.id;
          if (confirm('Bu yorumu silmek istediğinizden emin misiniz?')) {
            deleteComment(commentId, this);
          }
        });
      });
    }
    
    function deleteComment(commentId, buttonElement) {
      fetch(`/comments/${commentId}`, {
        method: 'DELETE',
        headers: {
          'Accept': 'application/json'
        }
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          // DOM'dan yorumu kaldır
          const commentItem = buttonElement.closest('.comment-item');
          if (commentItem) {
            commentItem.remove();
            
            // Eğer hiç yorum kalmadıysa mesaj göster
            const commentsContainer = document.getElementById('commentsContainer');
            if (commentsContainer.children.length === 0) {
              const noCommentsMessage = document.createElement('div');
              noCommentsMessage.id = 'no-comments-message';
              noCommentsMessage.className = 'text-center py-6';
              noCommentsMessage.innerHTML = `
                <p class="text-gray-400 mb-2">Henüz yorum yapılmamış</p>
                <p class="text-gray-500 text-sm">İlk yorumu yapan siz olun!</p>
              `;
              commentsContainer.appendChild(noCommentsMessage);
            }
          }
        } else {
          alert(data.message || 'Yorum silinirken bir hata oluştu.');
        }
      })
      .catch(error => console.error('Yorum silme hatası:', error));
    }
    
    // Silme butonlarını başlat
    initDeleteButtons();
  });
</script>

<%- include('partials/footer') %> 